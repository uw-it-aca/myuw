{% load templatetag_handlebars %}
    {% tplhandlebars "course_card_content" %}

<h3 id="your_courses" class="sr-only">Your Courses</h3>
<div aria-labeledby="your_courses">

    {{#each sections}}
    <div class="card c{{color_id}}Border">
    <div class="fade-in">
    
        <div id="course_wrapper{{index}}" class="OFF" style="position:relative;">
                
            <h4><span class="courseIDtitle">{{ curriculum_abbr }} {{course_number}} {{section_id}}</span>
            <span class="shortTitle" style="display:block; font-size: 16px; color:#444;">{{ course_title }}</span></h4>
            
            <h5 class="scheduleHeading">{{ucfirst meetings.0.type}} Schedule</h5>
            
            {{ #if canvas_grade }}
            <div class="canvasGradeBox" style="position: absolute; width: 100px; top: -3px; right:0;">
                <span class="canvasGrade" style="font-size: 22px;">{{ canvas_grade }}%</span>
                <span class="canvasGradeLabel" style="font-size: 12px; cursor: pointer; display:block; margin-top:-3px;" title="See note">Canvas Grade *</span>
            </div>
            {{ /if }}
            
            <table class="table table-condensed">
               
               <thead class="sr-only">
                   <tr>
                        <th>Day(s)</th>
                        <th>Time</th>
                        <th>Location</th>
                   </tr>
               </thead>
                
                <tbody>
                    {{#each meetings}} 
                    <tr>
                        {{#if days_tbd }}
                        <td colspan="2">Days and times to be arranged</td>
                        {{else}}
                        <td>
                            {{#if meeting_days.monday}}<abbr title="Monday">M</abbr>{{/if}}{{#if
                            meeting_days.tuesday}}<abbr title="Tuesday">T</abbr>{{/if}}{{#if
                            meeting_days.wednesday}}<abbr title="Wednesday">W</abbr>{{/if}}{{#if
                            meeting_days.thursday}}<abbr title="Thursday">Th</abbr>{{/if}}{{#if
                            meeting_days.friday}}<abbr title="Friday">F</abbr>{{/if}}{{#if
                            meeting_days.saturday}}<abbr title="Saturday">Sa</abbr>{{/if}}{{#if
                            meeting_days.sunday}}<abbr title="Sunday">Su</abbr>{{/if}}
                        </td>
                        <td>{{formatTime start_time}} - {{formatTimeAMPM end_time}}</td>
                        {{/if}}
                        {{#if building_tbd}}
                        <td>Room to be arranged</td>
                        {{else}}
                        <td>
                            {{#if latitude}}
                            <a href="http://maps.google.com/maps?q={{ latitude }},{{ longitude }}+({{encodeForMaps building_name }})&z=18" target="_blank" class="show_map" rel="{{building_name}}">
                            {{/if}}
                            {{building}} {{room}}
                            {{#if latitude}}</a>{{/if}}
                        </td>
                        {{/if}}
                    </tr>
                    {{/each}}
                </tbody>
                
            </table>
            
            <div id="course{{index}}" class="slide-hide" rel="{{ curriculum_abbr }} {{course_number}} {{section_id}}" aria-hidden="true">
                
                <div>
                    <h5>Course resources</h5>     
                    <ul class="unstyled-list">
                        {{#if has_resources }}
                            {{#if class_website_url}}
                            <li><a href="{{class_website_url}}" target="_blank" class="course_website" rel="{{ curriculum_abbr }} {{course_number}} {{section_id}}">Course Website</a></li>
                            {{/if}}       
                            {{#if canvas_url}}
                            <li><a href="{{canvas_url}}" target="_blank" class="course_canvas_site" rel="{{ curriculum_abbr }} {{course_number}} {{section_id}}">Course Canvas</a></li>
                            {{/if}} 
                        {{/if}}
                        <li><a class="show_course_textbook" href="/mobile/textbooks/{{../year}},{{../quarter}}{{#if ../summer_term}},{{toLowerCase ../summer_term}}{{/if}}/{{curriculum_abbr}}{{course_number}}{{section_id}}">Textbooks</a></li>
                    </ul>
                </div>

                {{#if instructors}}
                <div class="instructors">
                    <h5>Instructors</h5>
                    <ol>
                        {{#each instructors}}
                        <li class="instructor-container">
                            <h6>{{full_name}}</h6>
                            
                            
                            <div class="contact-info-container">
                                {{# if whitepages_publish}}
                                <span style="display: block;">{{title1}}</span>
                                <span style="display: block;"><a href="mailto:{{email1}}">{{email1}}</a>
                                <span style="display: block;"><a href="tel:+1{{phone1}}">{{phone1}}</a><br />
                                    {{# if phone2}}
                                    <a href="tel:+1{{phone2}}">{{phone2}}</a></span>
                                    {{/if}}
                                <span style="display: block;">{{address1}}</span>
                                {{else}}
                                <span class="todo">no contact information available</span>
                                {{/if}}
                            </div>
                            
                        </li>
                        {{/each}}
                    </ol>
                </div>
                {{/if}}

                {{ #if canvas_grade }}
                <div class="canvasGradeBox" style="font-style: italic; color: #888;">
                    <p><strong>* Canvas Grade</strong></p>
                    <p>Depending on how your instructor has configured Canvas, this grade calculation may be for points needed for the entire quarter, rather than for course work due to date.</p>
                </div>
                {{ /if }}

            </div>
            
            <div class="card-disclosure">
                <a class="slide-link" href="#" aria-controls="course{{index}}" title="Show more course information">Show more</a>                    
            </div>
            
        </div>
        
    </div>
    </div>
    {{/each}}
    
{% endtplhandlebars %}
